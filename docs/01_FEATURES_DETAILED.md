# 🎨 VTS 功能详解 - 需求规范

**Document ID:** 01_FEATURES_DETAILED.md  
**Status:** Draft for Review  
**Last Updated:** 2025-12-04

---

## 目录

1. [Tierlist 排行榜 + 角色详情卡](#1-tierlist-排行榜--角色详情卡)
2. [B 站封面生成](#2-b-站封面生成)
3. [一图流生成（可延后）](#3-一图流生成可延后)
4. [HUD 解说框（可延后）](#4-hud-解说框可延后)
5. [卡池预测时间轴（可延后）](#5-卡池预测时间轴可延后)
6. [排轴实验室（商用 Demo 集成，未来版本）](#6-排轴实验室商用-demo-集成未来版本)

---

## 1. Tierlist 排行榜 + 角色详情卡

### 1.1 功能概述

**核心交互：**
- 全屏排行榜网格，支持拖拽调整排序
- 点击角色头像 → **3D 卡片飞出侧放**，展示详情卡
- 关闭详情卡 → 回到排行榜
- 两种模式切换：Editor Mode（显示工具栏） vs Presentation Mode（全屏纯净）

### 1.2 Tierlist 页面设计

#### 布局规范

**屏幕分辨率：** 1920×1080 (Desktop First)

```
┌─────────────────────────────────────────────────┐
│  Tier  │          Character Grid                │
├────────┼─────────────────────────────────────────┤
│ T0     │ [头像] [头像] [头像]                     │
│ T0.5   │ [头像] [头像] [头像] [头像]              │
│ T1     │ [头像] [头像] [头像] [头像] [头像]       │
│ T2     │ [头像] [头像] [头像] [头像] [头像] ...   │
│ T3     │ [头像] [头像] [头像] [头像] [头像] ...   │
│ T4     │ [头像] [头像] [头像] [头像] [头像] ...   │
└────────┴─────────────────────────────────────────┘
```

**左侧 Tier 列：**
- 宽度：120px
- 显示 Tier 标签（T0、T0.5、T1... T4）
- 背景色按 Tier 渐进（红 → 橙 → 黄 → 绿 → 蓝）
- 支持拖拽更改 Tier（未来功能，v1.0 可暂不做）

**右侧网格区：**
- 每个角色头像：120×120px（可调）
- 网格间距：16px
- 支持多行排列（自动换行）
- 响应式高度（按内容撑满）

#### 交互细节

**拖拽排序：**
- 点击 + 按住头像 → 显示"浮起"视觉反馈（阴影、放大）
- 拖拽到同一 Tier 内其他位置 → 交换顺序
- 拖拽到不同 Tier → 移动到新 Tier（支持插入任意位置）
- 释放 → 动画返回原位置，更新排序

**点击交互：**
- 快速点击头像（< 300ms） → 展开详情卡（3D 动画）
- 长按头像（> 500ms） → 触发拖拽模式（视觉反馈变化）

**Editor vs Presentation 模式：**

| 元素 | Editor Mode | Presentation Mode |
|------|-------------|-------------------|
| 工具栏 | ✓ 显示 | ✗ 隐藏 |
| 网格线 | ✓ 显示 | ✗ 隐藏 |
| Tier 标签 | ✓ 显示 | ✓ 显示（但样式更精简） |
| 拖拽功能 | ✓ 启用 | ✗ 禁用（只读） |
| 快捷键 | ✓ 启用 | ✗ 禁用 |

### 1.3 角色详情卡

#### 打开动画规范

**当用户点击排行榜中的角色头像时：**

```
Step 1: 触发动画时间线 (250ms total)
  ├─ 0ms-50ms: 头像缩小 (scale: 1 → 0.8)
  ├─ 50ms-150ms: 卡片从头像位置飞出，旋转侧放
  │            rotateY: 0° → 15°
  │            rotateZ: 0° → -5°
  │            position: center → right side (60% offset)
  ├─ 150ms-250ms: 卡片停靠到右侧，背景模糊淡入
  └─ 250ms+: 卡片静止，可交互

Step 2: 最终状态
  - 卡片停靠位置：屏幕右侧，距离右边缘 60px
  - 垂直位置：居中或略高（由卡片高度决定）
  - 卡片尺寸：480×680px（或按内容高度伸缩，最大 70% 屏幕高度）
  - 背景：全屏半透明暗化 (rgba(0,0,0,0.6))
```

**关闭动画（点击背景或关闭按钮）：**
```
反向动画 (200ms total)
  ├─ 卡片缩小 + 旋转回 0°
  ├─ 飞回到原头像位置
  └─ 头像恢复正常尺寸
```

#### 详情卡内容结构

**高度优先级排列：**

```
┌─────────────────────────────────┐
│  [关闭按钮 X]    角色名称         │  ← Header (80px)
├─────────────────────────────────┤
│                                 │
│     [立绘 / 角色卡面]             │  ← Visual (280px)
│                                 │
├─────────────────────────────────┤
│  ⭐ 强度评价: S+ / 4.5★         │  ← 快速扫一眼评分
├─────────────────────────────────┤
│  📍 定位: 输出 / 辅助           │
├─────────────────────────────────┤
│  🎯 推荐队友:                   │
│      [头像] [头像] [头像]        │
├─────────────────────────────────┤
│  ⚔️ 推荐武器:                   │
│      [武器名] + [等级/精炼]      │
├─────────────────────────────────┤
│  🔮 推荐命座/意识:              │
│      优先级 1: [命座名]          │
│      优先级 2: [命座名]          │
├─────────────────────────────────┤
│  🎮 技能加点优先级:             │
│      1. 普攻  ▓▓▓               │
│      2. 战技  ▓▓░               │
│      3. 终极  ▓░░               │
├─────────────────────────────────┤
│  📊 属性雷达图:                 │
│      [6边形雷达图]               │  ← 见下文规范
└─────────────────────────────────┘
```

#### 数据字段定义

```typescript
interface CharacterDetailCard {
  // 基本信息
  id: string;
  name: string;
  rarity: number; // 1-5
  
  // 评价
  strengthRating: 'S+' | 'S' | 'A+' | 'A' | 'B+' | 'B' | 'C';
  strengthScore: number; // 0-5
  
  // 定位 (游戏特定，通过 GameConfig 映射)
  position: string; // e.g., "输出/辅助" or "Single Target"
  
  // 推荐队友
  recommendedTeammates: Array<{
    characterId: string;
    synergy: 'High' | 'Medium' | 'Low';
  }>;
  
  // 武器配置
  recommendedWeapon?: {
    name: string;
    refinement?: number; // 1-5
    priority: number; // 1-3
  };
  
  // 命座/意识 (游戏特定)
  ascensions?: Array<{
    name: string;
    priority: number;
    description?: string;
  }>;
  
  // 技能优先级
  skillPriority: Array<{
    skillName: string; // "Normal Attack" / "Skill" / "Ultimate"
    priority: number; // 1-3
    progress?: number; // 0-100, 可视化为进度条
  }>;
  
  // 属性雷达图
  radarStats: {
    dimension1: number; // 0-100
    dimension2: number;
    dimension3: number;
    dimension4: number;
    dimension5: number;
    dimension6: number;
  };
  
  // 视觉资源
  artwork?: string; // 立绘 URL
  icon?: string; // 头像 URL
}
```

#### 雷达图规范

**6 边形属性雷达图（Radar Chart）**

**适配游戏：**
- **P5X:** 攻击、防御、生命、命中、回避、暴击
- **Re1999:** 攻击、防御、治疗、控制、生存、效果抵抗
- **空之轨迹:** 复用 Re1999 样式

**设计规范：**
- 中心：100×100 的白色 SVG 容器（可缩放）
- 6 条轴线，各轴独立标签
- 数值范围：0-100（映射到半径）
- 最外圈：灰色背景（显示满值范围）
- 填充：游戏主题色，透明度 60%
- 边线：主题色，宽度 2px

```
示例 P5X (P3 风格):
      攻击
      / \
     /   \
    /     \
   生命   命中
    \     /
     \   /
      \ /
     回避-防御-暴击

数值示例:
- 攻击: 85
- 防御: 45
- 生命: 72
- 命中: 68
- 回避: 55
- 暴击: 92
```

---

## 2. B 站封面生成

### 2.1 功能概述

**核心功能：**
- 快速生成符合 B 站规范的视频封面
- 支持大立绘 + 标题 + 副标题版式
- 完全支持中文字体
- 一键导出高分辨率 PNG (1280×720 @ 96DPI)

### 2.2 封面编辑界面

**布局：**
```
┌──────────────────────────────────┐
│  Preview (1280×720)              │ ← 实时预览
│                                  │
│  ┌────────────────────────────┐  │
│  │                            │  │
│  │   [立绘]  大标题             │  │
│  │            小副标题         │  │
│  │                            │  │
│  └────────────────────────────┘  │
└──────────────────────────────────┘
   右侧编辑面板
   ├─ 选择角色（从当前 Tierlist）
   ├─ 标题输入框
   ├─ 副标题输入框
   ├─ 字体选择 (宋体/黑体/思源)
   ├─ 颜色选择 (预设 + 自定义)
   ├─ 背景选择 (纯色/渐变/游戏主题)
   └─ [导出 PNG] 按钮
```

### 2.3 设计规范

**尺寸标准：**
- 显示尺寸：1280×720px
- 导出分辨率：1280×720 @ 96 DPI（确保上传 B 站后不模糊）

**排版规则：**

| 区域 | 位置 | 尺寸 | 说明 |
|------|------|------|------|
| 立绘 | 左侧 | 600×720 | 全高，背景透明或渐变 |
| 标题 | 右侧上方 | 640×200 | 大字体，游戏特定色 |
| 副标题 | 右侧下方 | 640×150 | 小字体，辅助信息 |

**字体规范：**
- **标题：** 黑体/思源黑 Bold，72pt
- **副标题：** 宋体/思源宋 Regular，36pt
- **备选字体：** Microsoft YaHei, 方正兰亭黑
- **中文支持：** 必须完全支持 GB2312 + 常见繁体字

**颜色系统：**
- 按游戏主题色自动选择（来自 GameConfig）
- 标题文字：游戏 primary color 或高对比色
- 背景渐变：游戏 primary → accent （45° 角度）
- 阴影：+2px 黑色 opacity 40% (增强文字可读性)

### 2.4 导出流程

```
用户点击 [导出 PNG]
    ↓
系统生成 Canvas + 绘制所有元素
    ↓
转换为 Blob (PNG format)
    ↓
浏览器触发下载
    ├─ 文件名: ${gameName}_${characterName}_cover_${timestamp}.png
    └─ 自动保存到用户 Downloads 文件夹
```

---

## 3. 一图流生成（可延后）

### 3.1 功能概述

**目标：** 生成适配小红书、微博、X 等社交平台的"一图流"长图

**输入：** 当前 Tierlist 排名 + 若干角色详情卡

**输出：** 竖向长图 (1080×2160 或自适应高度)

### 3.2 排版方案

**纵向分段模式：**
```
┌────────────────┐
│  标题栏         │ 100px
├────────────────┤
│  Tierlist 缩图 │ 400px
│  (T0-T4 概览)  │
├────────────────┤
│  TOP 3 角色卡  │ 300px × 3
│  (详细介绍)    │
├────────────────┤
│  推荐队伍配置  │ 400px
│  (4 个角色卡)  │
├────────────────┤
│  卡池预测 (简) │ 200px
│  (可选)        │
├────────────────┤
│  Footer        │ 80px
│  (账号/联系)   │
└────────────────┘
```

### 3.3 导出方案

- 支持自定义高度（内容自适应）
- 导出为 PNG (1080 宽，自动计算高度)
- 针对小红书的特殊优化（如内边距、字体大小）

---

## 4. HUD 解说框（可延后）

### 4.1 功能概述

**目标：** 生成类似直播 Overlay 的"队伍讲解"视图

**使用场景：** 
- 你用 OBS 录屏时，引入 VTS 生成的 HUD 层
- 叠加在游戏实机画面上
- 展示当前队伍的技能循环、属性、推荐配置

### 4.2 HUD 布局

**屏幕布局：**
```
┌──────────────────────────────────────┐
│ 左侧: 队伍角色卡                      │  右侧 (30%)
│                                      │  预留录制视频
│ ┌────────────────┐                   │
│ │ 角色 1 [技能卡] │                   │
│ │ 角色 2 [技能卡] │  中心区域         │  ┌──────┐
│ │ 角色 3 [技能卡] │                   │  │ 游戏  │
│ │ 角色 4 [技能卡] │                   │  │ 实机  │
│ └────────────────┘                   │  │ 或    │
│                                      │  │ 素材  │
│ 下方: 技能列表 / 转盘               │  │ 录制  │
│ ┌─────────┬─────────┬─────────┐     │  │      │
│ │ 普通攻击 │ 战技    │ 终极能力  │    │  └──────┘
│ │ CD: 0s  │ CD: 3s  │ CD: ∞    │    │
│ └─────────┴─────────┴─────────┘     │
└──────────────────────────────────────┘
```

### 4.3 交互

- **显示/隐藏：** 快捷键 Toggle HUD
- **角色切换：** 支持动态更新展示的队伍
- **技能动画：** 点击技能 → 显示释放动画 + 冷却时间

---

## 5. 卡池预测时间轴（可延后）

### 5.1 功能概述

**目标：** 可视化展示"未来版本的卡池预测"

**核心要素：**
- 时间轴（横向或纵向）
- 每期卡池块（支持拖拽排序）
- 卡池卖点标签（文字 + 图标）
- "预测 vs 已实装"标记

### 5.2 时间轴设计

```
预测期数 → [v1.0 - 1.4] [v1.5 - 1.8] [v2.0+]
          ├─────────┤ ├─────────┤ ├──────┤
      卡池卖点│ 角色A │ 角色B │  ...
          │ 武器    │ 武器   │
          │ [拖拽排序] ...
          
标记: ✓ 已实装 / ? 预测
```

### 5.3 交互

- **拖拽卡池块：** 调整卡池顺序
- **编辑卖点：** 点击卡池块 → 编辑卡池名称、卖点
- **标记预测：** 右键菜单标记为"预测/已实装"

---

## 6. 排轴实验室（商用 Demo 集成，未来版本）

### 6.1 现状

你已有排轴计算的完整 Demo，包含：
- 角色伤害计算逻辑
- 手动行动顺序配置
- 伤害数据可视化

### 6.2 v1.0 计划

- **暂不集成**（优先级较低）
- **预留 UI 框架** 在侧边栏菜单
- 后续版本再接入你的 Demo 逻辑

### 6.3 v2.0+ 规划

- 集成伤害计算逻辑
- 支持队伍对比、角色对比
- 共鸣收益计算

---

## 功能优先级总结

| 优先级 | 功能 | 交付时间 |
|--------|------|--------|
| **P0** | Tierlist + 详情卡 + 3D 动画 | 第 1-2 周 |
| **P0** | B 站封面生成 | 第 2-3 周 |
| **P1** | 一图流生成 | 第 4 周（可选） |
| **P1** | HUD 解说框 | 第 5 周（可选） |
| **P2** | 卡池时间轴 | v1.1（可选） |
| **P3** | 排轴实验室集成 | v2.0（未来） |

---

## 待确认项

- [ ] 角色数据来源（JSON / 手工录入 / API）？
- [ ] 立绘资源存储位置（本地 / CDN）？
- [ ] 中文字体是否需要本地打包或使用 Web Font？
- [ ] 性能目标（首屏加载时间？）
- [ ] 是否需要支持"保存/加载"排行榜配置（本地存储）？

**请在本文档中反馈调整意见。** 💬
